// http://paulirish.com/2011/requestanimationframe-for-smart-animating/
// http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating
// requestAnimationFrame polyfill by Erik MÃ¶ller. fixes from Paul Irish and Tino Zijdel
// MIT license
function addEvents(e,t){function i(i){var s=i.targetTouches,o=i.changedTouches[0];i.preventDefault();e.addEventListener("touchmove",t);n=o.pageX;r=o.pageY}function s(n){var r=n.targetTouches,i=n.changedTouches[0],o=i.pageX,u=i.pageY;n.preventDefault();e.removeEventListener("touchmove",t);e.removeEventListener("touchend",s)}var n,r;e.addEventListener("touchstart",i)}function makeClass(){return function(e){if(!(this instanceof arguments.callee))return new arguments.callee(arguments);typeof this.init=="function"&&this.init.apply(this,e.callee?e:arguments)}}function randoHexColor(){return Math.random().toString(16).substring(2,8)}function randRGBA(){var e=[rand(255),rand(255),rand(255),Math.round(Math.random()*100)/100];return"rgba("+e.join(",")+")"}function rand(e){return Math.floor(Math.random()*e)}(function(){var e=0,t=["ms","moz","webkit","o"];for(var n=0;n<t.length&&!window.requestAnimationFrame;++n){window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"]}window.requestAnimationFrame||(window.requestAnimationFrame=function(t,n){var r=(new Date).getTime(),i=Math.max(0,16-(r-e)),s=window.setTimeout(function(){t(r+i)},i);e=r+i;return s});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})})();var Circle=makeClass();Circle.prototype.init=function(e,t,n,r){this.x=rand(e);this.y=rand(t);this.radius=rand(n);this.color=randRGBA();this.velocity={x:rand(r)-Math.floor(r/2),y:rand(r)-Math.floor(r/2)}};var cirs=[];$(document).ready(function(){function o(){r=window.innerWidth;i=window.innerHeight;t.width=r;t.height=i;console.log(i);s=Math.floor(i/2);n=t.getContext("2d")}function a(){n.clearRect(0,0,r,i);for(var t=0;t<cirs.length;t++){n.beginPath();n.arc(cirs[t].x,cirs[t].y,cirs[t].radius*e,0,2*Math.PI,!1);n.closePath();n.fillStyle=cirs[t].color;n.fill();cirs[t].x+=cirs[t].velocity.x;cirs[t].y+=cirs[t].velocity.y;var s=cirs[t].radius;cirs[t].x<0-s&&(cirs[t].x=r+s);cirs[t].y<0-s&&(cirs[t].y=i+s);cirs[t].x>r+s&&(cirs[t].x=0-s);cirs[t].y>i+s&&(cirs[t].y-=0-s)}requestAnimationFrame(a)}var e=1,t=document.getElementById("can-bg"),n,r,i,s;addEvents(t,function(t){var n=t.targetTouches,r=t.changedTouches[0],i=e=r.pageX/window.innerWidth,s=window.innerHeight/r.pageY;t.preventDefault()});o();for(var u=0;u<400;u++)cirs.push(Circle(r,i,s,40));a()});